<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
    <meta charset="utf-8"/>
    <link href="/static/main/Scripts/jquery-ui-1.10.3.custom/css/mycss/jquery-ui-1.10.3.custom.css" rel="stylesheet" type="text/css" />
    <link href="/static/main/Scripts/font-awesome-4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <script type="text/javascript" src="/static/main/Scripts/jquery-ui-1.10.3.custom/js/jquery-1.10.1.js"></script>
    <script type="text/javascript" src="/static/main/Scripts/jquery-ui-1.10.3.custom/js/jquery-ui-1.10.3.custom.js"></script>
    <script src="/static/main/Scripts/echarts.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".linechart_pic,.piechart_pic,.barchart_pic,.columnchart_pic").click(function(){
                var th=$(this);
                var thClass=th.attr("class");
                var quId=th.parents(".surveyResultQu").find("input[name='quId']").val();
                var amchartdivId=null;
                if(thClass.indexOf("linechart_pic")>0){
                    amchartdivId="line_chart_"+quId;
                }else if(thClass.indexOf("piechart_pic")>0){
                    amchartdivId="pie_chart_"+quId;
                }else if(thClass.indexOf("barchart_pic")>0){
                    amchartdivId="bar_chart_"+quId;
                }else if(thClass.indexOf("columnchart_pic")>0){
                    amchartdivId="column_chart_"+quId;
                }
                th.parent().find(".dw_btn026.active").removeClass("active");
                th.addClass("active");
                if(amchartdivId!=null){
                    var amchartdivObj=$("#"+amchartdivId);
                    if(!amchartdivObj[0]){
                        var url="/survey_report/chartData";
                        var data="quId="+quId;
                        $.ajax({
                            url:url,
                            data:data,
                            type:"post",
                            success:function(msg){

                                $("#amchart_"+quId).find(".higChartSvg").hide();

                                if(thClass.indexOf("linechart_pic")>0){
                                    higLineChart(msg,quId);
                                }else if(thClass.indexOf("piechart_pic")>0){
                                    higPieChart(msg,quId);
                                }else if(thClass.indexOf("barchart_pic")>0){
                                    higBarChart(msg,quId);
                                }else if(thClass.indexOf("columnchart_pic")>0){
                                    higColumnChart(msg,quId);
                                }

                            }
                        });
                    }else{
                        $("#amchart_"+quId).find(".higChartSvg").hide();
                        amchartdivObj.show();
                    }
                }

                return false;
            });

            //$("")
            //$(".linechart_pic").click();
            //$(".piechart_pic").click();
            //$(".barchart_pic").click();
            $(".columnchart_pic").click();

            resetQuNum();
            function resetQuNum(){
                var quCoNums=$(".quCoNum");
                $.each(quCoNums,function(i,item){
                    $(this).html((i+1)+"、");
                });

            }
        });
        function getHighchartsData(quItemBody,charType){
            var quType=quItemBody.find("input[name='quType']").val();

            var categories=[];
            var series=new Array();
            var seriesData=new Array();
            var tagText="次数";
            var legendData=new Array();

            var seriesType = 'bar';
            if (charType==="Line") {
                seriesType = 'line';
            }

            if(quType==="CHENRADIO" || quType==="CHENCHECKBOX" ||  quType==="CHENSCORE"){

                if(charType==="PIE"){
                    seriesData=new Array();
                    var rowItemTrs=quItemBody.find(".rowItemTr");
                    $.each(rowItemTrs,function(){
                        //var rowItemOptionName=$(this).find("input[name='rowItemOptionName']").val();
                        var rowItemOptionName=$(this).find(".rowItemOptionName").text();
                        var thColumnItemTrs=$(this).next().find(".columnItemTr");
                        $.each(thColumnItemTrs,function(){
                            //var columnItemOptionName=$(this).find("input[name='columnItemOptionName']").val();
                            var columnItemOptionName=$(this).find(".columnItemOptionName").text();
                            var anCount=$(this).find("input[name='columnItemAnCount']").val();
                            //seriesData.push([rowItemOptionName+"|"+columnItemOptionName, parseInt(anCount)]);

                            var data = {};
                            data["value"] = parseInt(anCount);
                            data["name"] = rowItemOptionName+"|"+columnItemOptionName;
                            series.push(data);

                        });
                    });

                    /*
                    series=[{                                 //指定数据列
                        name: '选项',                          //数据列名
                        data: seriesData                      //数据
                    }];
                    */

                }else{



                    var columnItemTrs=quItemBody.find(".anColumnTable:eq(0) .columnItemTr");
                    $.each(columnItemTrs,function(){
                        //var columnItemOptionName=$(this).find("input[name='columnItemOptionName']").val();
                        var columnItemOptionName=$(this).find(".columnItemOptionName").text();
                        categories.push(columnItemOptionName);
                    });

                    var rowItemTrs=quItemBody.find(".rowItemTr");
                    $.each(rowItemTrs,function(){
                        //var rowItemOptionName=$(this).find("input[name='rowItemOptionName']").val();
                        var rowItemOptionName=$(this).find(".rowItemOptionName").text();
                        var thColumnItemTrs=$(this).next().find(".columnItemTr");
                        seriesData=new Array();
                        $.each(thColumnItemTrs,function(){
                            var anCount=$(this).find("input[name='columnItemAnCount']").val();
                            seriesData.push(parseInt(anCount));
                        });
                        series.push({                                 //指定数据列
                            name: rowItemOptionName,                //数据列名
                            //type:'bar',
                            type: seriesType,
                            data: seriesData                      //数据
                        });

                        legendData.push(rowItemOptionName);

                    });
                }

            }else{

                var seriesDataTemp="[";

                var quRadioOptions=quItemBody.find(".quTrOptions");
                $.each(quRadioOptions,function(i,item){
                    var quOptionName=$(this).find(".optionName").text();
                    var anCount=$(this).find("input[name='quItemAnCount']").val();

                    if(anCount==""){
                        anCount=0;
                    }
                    categories.push(quOptionName);
                    if(quType==="SCORE"){
                        var avgScore=$(this).find("input[name='quItemAvgScore']").val();
                        //平均分 setAvgScore
                        //alert(avgScore);
                        avgScore=parseFloat(avgScore).toFixed(2);
                        if(avgScore==="NaN"){
                            avgScore="0.00";
                        }
                        if(charType==="PIE"){
                            //seriesData.push([quOptionName,   parseFloat(avgScore)]);
                            var data = {};
                            data["value"] = parseFloat(avgScore);
                            data["name"] = quOptionName;
                            seriesData.push(data);
                        }else{
                            seriesData.push(parseFloat(avgScore));
                        }
                        tagText="分数";
                    } else if(quType==="ORDERQU"){
                        if(charType==="PIE"){
                            var data = {};
                            data["value"] = parseInt(anCount);
                            data["name"] = quOptionName;
                            seriesData.push(data);
                        }else{
                            seriesData.push(parseInt(anCount));
                        }
                        tagText="排名";
                    } else{
                        if(charType==="PIE"){
                            //seriesData[i]=new Array();
                            //seriesData[i][0]=quOptionName;
                            //seriesData[i][1]=parseInt(anCount);
                            var data = {};
                            data["value"] = parseInt(anCount);
                            data["name"] = quOptionName;
                            seriesData.push(data);
                        }else{
                            seriesData.push(parseInt(anCount));
                        }
                    }


                });

                if(charType==="PIE"){
                    /*
                    series=[{
                        type: 'pie',
                        data: seriesData
                    }];
                    */
                    series = seriesData;
                }else if(charType === "BAR"){
                    series=[{
                        //name: '选项',
                        name: tagText,
                        type: 'bar',
                        data: seriesData
                    }];
                }else{
                    /*series=[{                                 //指定数据列
                        name: '选项',                          //数据列名
                        data: seriesData                      //数据
                    }];*/
                    //series = seriesData;
                    series = [{
                        //name: '选项',
                        name: tagText,
                        //type: 'bar',
                        type: seriesType,
                        // barWidth: 80,
                        //data: [5, 20, 36, 10, 10, 20]
                        //data: [5, 20]
                        data: seriesData
                    }]
                }

            }

            return [categories,series,tagText,legendData];
        }


        function higColumnChart(resultJson,quId){
            //$("#"+chartdivId).css({"margin-top":"10px"});
            var chartdivId="column_chart_"+quId;
            $("#amchart_"+quId).prepend("<div id='"+chartdivId+"' class=\"higChartSvg\"></div>");
            $("#"+chartdivId).css({"height": "300px"});
            //$("#"+chartdivId).css({"width": "800px"});

            var quItemBody=$("#quTr_"+quId);
            var quTitle=quItemBody.find(".quCoTitleText").text();

            var quTypeName=quItemBody.find("input[name='quTypeCnName']").val();

            var datas=getHighchartsData(quItemBody,"column");
            var categories=datas[0];
            var series=datas[1];
            var tagText=datas[2];
            var legendData = datas[3];

            var myChart = echarts.init($('#'+chartdivId)[0],"shine");
            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: quTitle,
                    //     subtext: '来自调问 www.diaowen.net',
                    top: 8,
                    /*  left: 10, */
                    textStyle: {
                        fontSize: 16
                    },
                    x:'center'
                },
                toolbox: {
                    show : true,
                    feature : {
                        // magicType : {show: true, type: ['line', 'bar']},
                        saveAsImage : {show: true}
                    }
                },
                color: ['#7cb5ec'],
                backgroundColor: '#fff',
                tooltip : {
                    trigger: 'axis',
                    axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                        type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                    },
                    top:20
                },
                grid: {
                    left: '3%',
                    right: '3%',
                    bottom: '5%',
                    containLabel: true
                },
                xAxis: {
                    //data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"],
                    type : 'category',
                    data: categories,
                    axisTick: {
                        alignWithLabel: true
                    },
                    nameGap: 20,
                    axisLabel: {
                        //rotate: 5,
                        interval: 0,
                        margin: 15
                    },
                    axisLine:{
                        show: false,
                        lineStyle:{width: 1}
                    },
                    axisTick: {
                        show: false
                    }/*,
	    	splitLine: {show:true}

	    	splitArea:{
	    		interval: 0,
	    		show : true
	    	} */
                },
                yAxis: {
                    //minInterval: 2,
                    splitNumber: 5,
                    //nameLocation: 'middle',
                    //boundaryGap: ['30%', '30%'],
                    //nameGap: 20,
                    type:'value',
                    axisLine: {
                        show: false
                    },
                    axisTick: {
                        show: false
                    },
                    name: tagText
                },
                legend: {
                    bottom: 0,
                    data:legendData
                },
                series: series
            };

            /*
            option = {
                    tooltip: {
                        trigger: 'axis'
                    },
                    toolbox: {
                        feature: {
                            dataView: {show: true, readOnly: false},
                            magicType: {show: true, type: ['line', 'bar']},
                            restore: {show: true},
                            saveAsImage: {show: true}
                        }
                    },
                    backgroundColor: '#fff',
                    color: ['#7cb5ec'],
                    legend: {
                        top: 10,
                        data:['蒸发量','蒸发量1','蒸发量2']
                    },
                    xAxis: [
                        {
                            type: 'category',
                            data: ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月']
                           // data: series
                        }
                    ],
                    yAxis: [
                        {
                            type: 'value',
                            name: '水量',
                            min: 0,
                            max: 250,
                            interval: 50,
                            axisLabel: {
                                formatter: '{value} ml'
                            }
                        }
                    ],
                    series: [
                        {
                            name:'蒸发量',
                            type:'bar',
                            data:[2.0, 4.9, 7.0, 23.2, 25.6, 76.7, 135.6, 162.2, 32.6, 20.0, 6.4, 3.3]
                        },
                        {
                            name:'降水量',
                            type:'bar',
                            data:[2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]
                        },
                        {
                            name:'降水2量',
                            type:'bar',
                            data:[2.6, 5.9, 9.0, 26.4, 28.7, 70.7, 175.6, 182.2, 48.7, 18.8, 6.0, 2.3]
                        }
                    ]
                };
             */
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);
        }

        function higPieChart(resultJson,quId){

            //$("#"+chartdivId).css({"margin-top":"10px"});
            var chartdivId="pie_chart_"+quId;
            $("#amchart_"+quId).prepend("<div id='"+chartdivId+"' class=\"higChartSvg\"></div>");
            $("#"+chartdivId).css({"height": "300px"});

            var quItemBody=$("#quTr_"+quId);
            var quTitle=quItemBody.find(".quCoTitleText").text();
            var quTypeName=quItemBody.find("input[name='quTypeCnName']").val();

            var datas=getHighchartsData(quItemBody,"PIE");
            var series=datas[1];
            var tagText=datas[2];
            var categories = datas[0]
            var legendData = datas[3];

            // Build the chart
            var myChart = echarts.init($('#'+chartdivId)[0],"shine");
            var option = {
                title : {
                    text: quTitle,
                    //subtext: '来自调问 www.diaowen.net',
                    top: 8,
                    /*  left: 10, */
                    textStyle: {
                        fontSize: 16
                    },
                    x:'center'
                },
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                backgroundColor: '#fff',
                toolbox: {
                    show : true,
                    feature : {
                        saveAsImage : {show: true}
                    }
                },
                legend: {
                    // orient: 'vertical',
                    x : 'center',
                    y : 'bottom',
                    data: categories//['直接访问','邮件营销','联盟广告','视频广告','搜索引擎']
                },
                series :// series
                        [
                            {
                                //name: '访问来源',
                                name: tagText,
                                type: 'pie',
                                radius : '55%',
                                center: ['50%', '60%'],
                                data: series
                                /*[
                                    {value:335, name:'直接访问'},
                                    {value:310, name:'邮件营销'},
                                    {value:234, name:'联盟广告'},
                                    {value:135, name:'视频广告'},
                                    {value:1548, name:'搜索引擎'}
                                ]*/,
                                itemStyle: {
                                    emphasis: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                }
                            }
                        ]
            };
            myChart.setOption(option);

        }



        function higBarChart(resultJson,quId){

            //$("#"+chartdivId).css({"margin-top":"10px"});
            var chartdivId="bar_chart_"+quId;
            $("#amchart_"+quId).prepend("<div id='"+chartdivId+"' class=\"higChartSvg\"></div>");
            $("#"+chartdivId).css({"height": "300px"});

            var quItemBody=$("#quTr_"+quId);
            var quTitle=quItemBody.find(".quCoTitleText").text();
            var quTypeName=quItemBody.find("input[name='quTypeCnName']").val();

            var datas=getHighchartsData(quItemBody,"BAR");
            var categories=datas[0];
            var series=datas[1];
            var tagText=datas[2];
            var legendData = datas[3];

            var myChart = echarts.init($('#'+chartdivId)[0],"shine");
            var option = {
                title: {
                    text: quTitle,
                    //  subtext: '来自调问 www.diaowen.net',
                    top: 8,
                    /*  left: 10, */
                    textStyle: {
                        fontSize: 16
                    },
                    x:'center'
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    }
                },
                backgroundColor: '#fff',
                color: ['#7cb5ec'],
                legend: {
                    data: ['2011年', '2012年']
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '10%',
                    containLabel: true
                },
                toolbox: {
                    show : true,
                    feature : {
                        saveAsImage : {show: true}
                    }
                },
                xAxis: {
                    /*  type: 'value',
                     boundaryGap: [0, 0.01] */
                    type : 'value',
                    axisTick: {
                        alignWithLabel: true
                    },
                    nameGap: 12,
                    axisLabel: {
                        //rotate: 5,
                        interval: 0,
                        margin: 15
                    },
                    axisLine: {
                        show: false,
                        lineStyle:{width: 1}
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {show:true}
                },
                yAxis: {
                    type: 'category',
                    //data: ['巴西','印尼','美国','印度','中国','世界人口(万)']
                    data: categories
                },
                legend: {
                    bottom: 2,
                    data:legendData
                },
                series: series
                /*
                    [
                    {
                        name: '2011年',
                        type: 'bar',
                        data: [18203, 23489, 29034, 104970, 131744, 630230]
                    },
                    {
                        name: '2012年',
                        type: 'bar',
                        data: [19325, 23438, 31000, 121594, 134141, 681807]
                    }
                ]*/
            };
            myChart.setOption(option);
        }




        function higLineChart(resultJson,quId){
            //根据quId得到数据对象，并且解析

            var chartdivId="line_chart_"+quId;
            $("#amchart_"+quId).prepend("<div id='"+chartdivId+"' class=\"higChartSvg\"></div>");
            $("#"+chartdivId).css({"height": "300px"});

            var quItemBody=$("#quTr_"+quId);
            var quTitle=quItemBody.find(".quCoTitleText").text();
            var quTypeName=quItemBody.find("input[name='quTypeCnName']").val();

            var datas=getHighchartsData(quItemBody,"Line");
            var categories=datas[0];
            var series=datas[1];
            var tagText=datas[2];
            var legendData = datas[3];

            var myChart = echarts.init($('#'+chartdivId)[0],"shine");
            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: quTitle,
                    //   subtext: '来自调问 www.diaowen.net',
                    top: 8,
                    /*  left: 10, */
                    textStyle: {
                        fontSize: 16
                    },
                    x:'center'
                },
                toolbox: {
                    show : true,
                    feature : {
                        //   magicType : {show: true, type: ['line', 'bar']},
                        saveAsImage : {show: true}
                    }
                },
                backgroundColor: '#fff',
                color: ['#3398DB'],
                tooltip : {
                    trigger: 'axis',
                    axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                        type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                    },
                    top:20
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    //data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"],
                    /* type : 'category',
                    data: categories,
                    axisLine:{
                        lineStyle:{width: 1}
                    } */
                    type : 'category',
                    data: categories,
                    axisTick: {
                        alignWithLabel: true
                    },
                    nameGap: 20,
                    axisLabel: {
                        //rotate: 5,
                        interval: 0,
                        margin: 15
                    },
                    axisLine:{
                        show: false,
                        lineStyle:{width: 1}
                    },
                    axisTick: {
                        show: false
                    },
                    splitLine: {show:true}
                },
                yAxis: {
                    minInterval: 1,
                    name:'次数'
                },
                legend: {
                    bottom: 0,
                    data:legendData
                },
                series: series
                /*
                 series: [{
                     name: '选择',
                     type: 'line',
                     barWidth: 80,
                     //data: [5, 20, 36, 10, 10, 20]
                     //data: [5, 20]
                     data: series
                 }]
                 */
            };
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);

        }


        function substring(json) {
            var bufLen = json.length;
            var lastIndex = json.lastIndexOf(",");
            if (bufLen == (lastIndex + 1)) {
                json = json.substring(0, lastIndex);
            }
            return json;
        }
    </script>
    <style type="text/css">
        .dw_btn026 {
            border: 1px solid transparent;
        }

        .suQuTable {
            border: 1px solid #c5b6b6 ! important;
            width: 100%;
        }

        .anColumnTable {
            width: 100%;
        }

        .quTrOptions td {
            border-top: 1px dashed #c5b6b6 ! important;
        }

        .rowItemTr td {
            border-top: 1px solid #c5b6b6 ! important;
        }

        .columnItemTr td {
            border-top: 1px dashed #c5b6b6 ! important;
        }

        .suQuTable .quTrOptions:FIRST-CHILD td, .suQuTable .rowItemTr:FIRST-CHILD td, .suQuTable .columnItemTr:FIRST-CHILD td {
            border-top: none ! important;
        }

        .r-qu-body-title .quCoNum {
            float: left;
            padding: 5px 0px;
            padding-left: 8px;
        }

        .r-qu-body-title .quCoTitleText {
            float: left;
            padding: 5px 3px;
            cursor: text;
            table-layout: fixed;
            word-break: break-all;
            display: inline-block;
        }

        .higChartSvg {

        }
    </style>
</head>
<body>
<input type="hidden" id="id" name="id" value="${directory.id }">

<div id="dwBody">
    <div id="dwBodyContent" class="bodyCenter" style="border:1px solid #C1DAEC;">
        <div id="dwBodyUser">
            <div class="surveyCollectMiddle">
                <div class="surveyCollectTop">
                    <div class="surveyCollectTitleDiv">
                        <span class="surveyCollectTitle">${directory.surveyName }</span>
                    </div>
                    <div class="surveyCollectInfoDiv">
                        <span class="surveyCollectInfoLeft">
                        状态：<span class="collectInfoSpan">收集中</span>&nbsp;&nbsp;&nbsp;&nbsp;
                参与人数：<span class="collectInfoSpan">${(directory.answerNum)!0 }</span>
                        </span>
                                        <span class="surveyCollectInfoRight">
                        创建时间：<span class="collectInfoSpan">${directory.createDate?string('yyyy年MM月dd日 HH:mm')}</span>
                        </span>
                    </div>
                </div>

                <div class="surveyCollectMiddleContent">
                    <div style="padding: 15px 25px;overflow: auto;">
                        <div style="overflow: auto;">
                            <div style="float: left;">
                                <a href=""
                                   class="dw_btn025 tabpic active"><i class="fa fa-refresh"></i>&nbsp;刷新</a>
                            </div>
                            <div style="float: right;">
                                <a href="/survey_report/exportXLS?surveyId=${directory.id}" download=""
                                   class="dw_btn025"><i class="fa fa-download"></i>下载数据</a>
                            </div>
                        </div>
                        <div style="padding-top:8px;">
                            <div class="" style="border: 1px solid #D1D6DD;padding: 0px;">
                                <table id="content-tableList" width="100%" cellpadding="0" cellspacing="0">
                                    <#list surveyStats.questions as en>
                                        <#if (en.quType != 'PARAGRAPH' && en.quType != 'PAGETAG'  )>
                                            <tr id="quTr_${en.id }">
                                                <td colspan="3">
                                                    <div class="surveyResultQu">
                                                        <input type="hidden" name="quId" value="${en.id }">
                                                        <input type="hidden" name="quType" value="${en.quType }">
                                                        <input type="hidden" name="quAnCount" value="${en.anCount }">
                                                        <input type="hidden" name="quTypeCnName"
                                                               value="${en.quType.cnName }">


                                                        <div class="r-qu-body-title">
                                                            <div class="quCoNum">${en_index }、</div>
                                                            <div class="quCoTitleText">${en.quTitle }
                                                                [${en.quType.cnName }]
                                                            </div>
                                                        </div>
                                                        <div class="r-qu-body-content">
                                                                <!--单选题 -->
                                                                <#if (en.quType == 'RADIO' )>
                                                                    <table class="suQuTable" border="0" cellpadding="0"
                                                                           cellspacing="0">
                                                                        <#list en.quRadios  as quEn>
                                                                            <tr class="quTrOptions">
                                                                                <td width="15px">&nbsp;</td>
                                                                                <td width="520px"
                                                                                    class="optionName">${quEn.optionName }</td>
                                                                                <td width="180px">
                                                                                </td>
                                                                                <td width="60px" align="right"
                                                                                    id="bfbNum${en.quType }${en_index }_${quEn_index}"
                                                                                    class="bfbTd">0%
                                                                                </td>
                                                                                <td align="left" class="tdAnCount">
                                                                                    &nbsp;&nbsp;${quEn.anCount }次
                                                                                </td>
                                                                                <td width="40px">&nbsp;
                                                                                    <input type="hidden"
                                                                                           name="quItemAnCount"
                                                                                           value="${quEn.anCount }">
                                                                                </td>
                                                                            </tr>
                                                                            <script type="text/javascript">
                                                                                var count = parseInt("${en.anCount }");
                                                                                var anCount = parseInt("${quEn.anCount }");
                                                                                if (count == 0) {
                                                                                    count = 1;
                                                                                }
                                                                                var bfbFloat = anCount / count * 100;
                                                                                var bfbVal = bfbFloat.toFixed(2);
                                                                                $("#bfbNum${en.quType }${en_index }_${quEn_index}").html(bfbVal + "%");
                                                                            </script>
                                                                        </#list>
                                                                    </table>
                                                                <div class="reportPic">
                                                                    <div class="chartBtnEvent">
                                                                        <a href="#" class="dw_btn026 columnchart_pic"><i class="fa fa-bar-chart"></i>柱状图</a>
                                                                        <a href="#" class="dw_btn026 piechart_pic"><i class="fa fa-pie-chart"></i>饼图</a>
                                                                        <a href="#" class="dw_btn026 barchart_pic"><i class="fa fa-tasks"></i>条形图</a>
                                                                        <a href="#" class="dw_btn026 linechart_pic"><i class="fa fa-line-chart"></i>折线图</a>
                                                                    </div>
                                                                    <div style="clear: both;"></div>
                                                                    <div id="amchart_${en.id }" ></div>
                                                                </div>
																	<div style="clear:both;">
                                                                <!--多选题 -->
                                                                <#elseif (en.quType == 'CHECKBOX' )>
                                                                    <table class="suQuTable" border="0" cellpadding="0"
                                                                           cellspacing="0">
                                                                        <#list en.quCheckboxs  as quEn>
                                                                            <tr class="quTrOptions">
                                                                                <td width="15px">&nbsp;</td>
                                                                                <td width="520px"
                                                                                    class="optionName">${quEn.optionName }</td>
                                                                                <td width="180px">
                                                                                </td>
                                                                                <td width="60px" align="right"
                                                                                    id="bfbNum${en.quType }${en_index }_${quEn_index}"
                                                                                    class="bfbTd">0%
                                                                                </td>
                                                                                <td align="left" class="tdAnCount">
                                                                                    &nbsp;&nbsp;${quEn.anCount!'0' }次
                                                                                </td>
                                                                                <td width="40px">&nbsp;
                                                                                    <input type="hidden"
                                                                                           name="quItemAnCount"
                                                                                           value="${quEn.anCount!'0' }">
                                                                                </td>
                                                                            </tr>
                                                                            <script type="text/javascript">
                                                                                var count = parseInt("${en.anCount }");
                                                                                var anCount = parseInt("${quEn.anCount }");
                                                                                var bfbFloat = anCount / count * 100;
                                                                                var bfbVal = bfbFloat.toFixed(2);
                                                                                if (bfbVal === "NaN") {
                                                                                    bfbVal = "0.00";
                                                                                }
                                                                                $("#bfbNum${en.quType }${en_index }_${quEn_index}").html(bfbVal + "%");
                                                                            </script>
                                                                        </#list>
                                                                    </table>
                                                                    <div class="reportPic">
                                                                        <div class="chartBtnEvent">
                                                                            <a href="#" class="dw_btn026 columnchart_pic"><i class="fa fa-bar-chart"></i>柱状图</a>
                                                                            <a href="#" class="dw_btn026 piechart_pic"><i class="fa fa-pie-chart"></i>饼图</a>
                                                                            <a href="#" class="dw_btn026 barchart_pic"><i class="fa fa-tasks"></i>条形图</a>
                                                                            <a href="#" class="dw_btn026 linechart_pic"><i class="fa fa-line-chart"></i>折线图</a>
                                                                        </div>
                                                                        <div style="clear: both;"></div>
                                                                        <div id="amchart_${en.id }" ></div>
                                                                    </div>
																	<div style="clear:both;"></div>
                                                                <!--填空 -->
                                                                <#elseif (en.quType == 'FILLBLANK' )>
                                                                    <table class="suQuTable" border="0" cellpadding="0"
                                                                           cellspacing="0"
                                                                           style="border: none! important;margin-top: 8px;">
                                                                        <tr>
                                                                            <td width="15px">&nbsp;</td>
                                                                            <td class="bfbTd">回答数：${en.anCount }条&nbsp;&nbsp;<a href="/survey_report/fillblank_answerList_html?quId=${en.id}&surveyId=${directory.id}"
                                                                                    class="fb_answer">查看</a></td>
                                                                            <td colspan="4">&nbsp;</td>
                                                                        </tr>
                                                                    </table>
                                                                    <div style="clear:both;"></div>
                                                                <!--组合填空 -->
                                                                <#elseif (en.quType == 'MULTIFILLBLANK' )>
                                                                    <!-- getQuMultiFillblanks -->
                                                                    <table class="suQuTable" border="0" cellpadding="0"
                                                                           cellspacing="0">
                                                                        <#list en.quMultiFillblanks as quEn>
                                                                            <tr class="quTrOptions">
                                                                                <td width="15px">&nbsp;</td>
                                                                                <td width="520px">${quEn.optionName }</td>
                                                                                <td class="bfbTd">回答数：${quEn.anCount }条&nbsp;&nbsp;<a
                                                                                        href="/survey_report/fillblank_answerList_html?quId=${quEn.id}&surveyId=${directory.id}">查看</a>
                                                                                </td>
                                                                                </td>
                                                                                <td colspan="4"></td>
                                                                            </tr>
                                                                        </#list>
                                                                    </table>
                                                                    <div class="reportPic"></div>
                                                                    <div style="clear:both;"></div>
                                                                </#if>

                                                        </div>
                                                    </div>

                                                </td>
                                            </tr>
                                        </#if>

                                    </#list>
                                </table>

                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>


</body>
</html>
